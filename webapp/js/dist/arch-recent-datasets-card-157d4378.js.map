{"version":3,"file":"arch-recent-datasets-card-157d4378.js","sources":["../../../src/src/archRecentDatasetsCard/src/styles.ts","../../../src/src/archRecentDatasetsCard/src/arch-recent-datasets-card.ts"],"sourcesContent":["import { css } from \"lit\";\n\nimport { global, cardTable } from \"../../lib/styles\";\n\nexport default [\n  global,\n  cardTable,\n  css`\n    thead > tr.hidden-header {\n      color: transparent;\n    }\n\n    th.date {\n      width: 8rem;\n      text-align: right;\n    }\n\n    td.name,\n    td.collection {\n      text-overflow: ellipsis;\n      white-space: nowrap;\n      overflow-x: hidden;\n    }\n\n    td.date {\n      text-align: right;\n    }\n  `,\n];\n","import { LitElement, html } from \"lit\";\nimport { customElement, state } from \"lit/decorators.js\";\n\nimport ArchAPI from \"../../lib/ArchAPI\";\nimport { Paths } from \"../../lib/helpers\";\nimport { Dataset, FilteredApiResponse } from \"../../lib/types\";\nimport { isoStringToDateString } from \"../../lib/webservices/src/lib/helpers\";\n\nimport \"../../archCard/index\";\nimport \"../../archLoadingIndicator/index\";\n\nimport styles from \"./styles\";\n\n@customElement(\"arch-recent-datasets-card\")\nexport class ArchRecentDatasetsCard extends LitElement {\n  @state() numTotalDatasets = 0;\n  @state() datasets: undefined | Array<Dataset> = undefined;\n\n  static maxDisplayedDatasets = 10;\n  static styles = styles;\n\n  constructor() {\n    super();\n    void this.initDatasets();\n  }\n\n  render() {\n    const { numTotalDatasets } = this;\n    const isLoading = this.datasets === undefined;\n    // Note that the value of hasDatasets is only valid when isLoading=false;\n    const hasDatasets = (this.datasets ?? []).length > 0;\n    const datasets = this.datasets ?? [];\n\n    const getRows = () =>\n      isLoading\n        ? [\n            html`<tr>\n              <td colspan=\"3\">\n                <arch-loading-indicator></arch-loading-indicator>\n              </td>\n            </tr>`,\n          ]\n        : !hasDatasets\n        ? [\n            html`<tr>\n              <td colspan=\"3\"><i>New datasets will be listed here.</i></td>\n            </tr>`,\n          ]\n        : datasets.map((dataset) => {\n            const name = `${dataset.name}${\n              dataset.sample !== -1 ? \" (Sample)\" : \"\"\n            }`;\n            return html`\n              <tr>\n                <td class=\"name\">\n                  <a\n                    href=\"${Paths.dataset(dataset.id, dataset.sample)}\"\n                    title=\"${name}\"\n                  >\n                    ${name}\n                  </a>\n                </td>\n                <td class=\"collection\" title=\"${dataset.collectionName}\">\n                  ${dataset.collectionName}\n                </td>\n                <td class=\"date\">\n                  ${isoStringToDateString(dataset.finishedTime as Date)}\n                </td>\n              </tr>\n            `;\n          });\n\n    return html`\n      <arch-card\n        title=\"Recent Datasets\"\n        ctatext=\"Generate New Dataset\"\n        ctahref=\"/datasets/generate\"\n      >\n        <div slot=\"content\">\n          <table>\n            <thead>\n              <tr class=\"${isLoading || !hasDatasets ? \"hidden-header\" : \"\"}\">\n                <th class=\"name\">Dataset</th>\n                <th class=\"collection\">Collection Name</th>\n                <th class=\"date\">Date Generated</th>\n              </tr>\n            </thead>\n            <tbody>\n              ${getRows()}\n            </tbody>\n          </table>\n        </div>\n        <div slot=\"footer\">\n          ${isLoading || !hasDatasets\n            ? html``\n            : html`\n                <a href=\"/datasets/explore\" class=\"view-all\">\n                  View\n                  ${datasets.length < numTotalDatasets\n                    ? html`All ${numTotalDatasets}`\n                    : html``}\n                  Datasets\n                </a>\n              `}\n        </div>\n      </arch-card>\n    `;\n  }\n\n  private async initDatasets() {\n    const response = (await ArchAPI.datasets.get([\n      [\"state\", \"=\", \"Finished\"],\n      [\"sort\", \"=\", \"-startTime\"],\n      [\"limit\", \"=\", ArchRecentDatasetsCard.maxDisplayedDatasets],\n    ])) as FilteredApiResponse<Dataset>;\n    this.numTotalDatasets = response.count;\n    this.datasets = response.results;\n  }\n}\n\n// Injects the tag into the global name space\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"arch-recent-datasets-card\": ArchRecentDatasetsCard;\n  }\n}\n"],"names":["styles","global","cardTable","css","ArchRecentDatasetsCard","ArchRecentDatasetsCard_1","LitElement","constructor","super","this","numTotalDatasets","datasets","undefined","initDatasets","render","isLoading","hasDatasets","_a","length","_b","html","map","dataset","name","sample","Paths","id","collectionName","isoStringToDateString","finishedTime","async","response","ArchAPI","get","maxDisplayedDatasets","count","results","__decorate","state","prototype","customElement"],"mappings":"sgBAIA,MAAeA,EAAA,CACbC,EACAC,EACAC,CAAG;;;;;;;;;;;;;;;;;;;;KCOE,IAAMC,EAAsBC,EAA5B,cAAqCC,EAO1CC,cACEC,QAPOC,KAAgBC,iBAAG,EACnBD,KAAQE,cAA+BC,EAOzCH,KAAKI,cACX,CAEDC,iBACE,MAAMJ,iBAAEA,GAAqBD,KACvBM,OAA8BH,IAAlBH,KAAKE,SAEjBK,GAAgC,QAAjBC,EAAAR,KAAKE,gBAAY,IAAAM,EAAAA,EAAA,IAAIC,OAAS,EAC7CP,EAAwB,QAAbQ,EAAAV,KAAKE,gBAAQ,IAAAQ,EAAAA,EAAI,GAyClC,OAAOC,CAAI;;;;;;;;;2BASYL,IAAcC,EAAc,gBAAkB;;;;;;;gBA/CnED,EACI,CACEK,CAAI;;;;oBAMLJ,EAMDL,EAASU,KAAKC,IACZ,MAAMC,EAAO,GAAGD,EAAQC,QACF,IAApBD,EAAQE,OAAgB,YAAc,KAExC,OAAOJ,CAAI;;;;4BAIKK,EAAMH,QAAQA,EAAQI,GAAIJ,EAAQE;6BACjCD;;sBAEPA;;;gDAG0BD,EAAQK;oBACpCL,EAAQK;;;oBAGRC,EAAsBN,EAAQO;;;aAGrC,IA1BH,CACET,CAAI;;;;;;;YAiDJL,IAAcC,EACZI,CAAI,GACJA,CAAI;;;oBAGET,EAASO,OAASR,EAChBU,CAAI,OAAOV,IACXU,CAAI;;;;;;KAOvB,CAEOU,qBACN,MAAMC,QAAkBC,EAAQrB,SAASsB,IAAI,CAC3C,CAAC,QAAS,IAAK,YACf,CAAC,OAAQ,IAAK,cACd,CAAC,QAAS,IAAK5B,EAAuB6B,wBAExCzB,KAAKC,iBAAmBqB,EAASI,MACjC1B,KAAKE,SAAWoB,EAASK,OAC1B,GAnGMhC,EAAoB8B,qBAAG,GACvB9B,EAAMJ,OAAGA,EAJPqC,EAAA,CAARC,KAA6BlC,EAAAmC,UAAA,wBAAA,GACrBF,EAAA,CAARC,KAAyDlC,EAAAmC,UAAA,gBAAA,GAF/CnC,EAAsBC,EAAAgC,EAAA,CADlCG,EAAc,8BACFpC"}