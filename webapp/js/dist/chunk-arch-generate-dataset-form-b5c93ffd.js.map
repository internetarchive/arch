{"version":3,"file":"chunk-arch-generate-dataset-form-b5c93ffd.js","sources":["../../../src/src/lib/types.ts","../../../src/src/archGenerateDatasetForm/src/arch-job-card.ts","../../../src/src/archGenerateDatasetForm/src/arch-job-category-section.ts","../../../src/src/archGenerateDatasetForm/src/styles.ts","../../../src/src/archGenerateDatasetForm/src/arch-generate-dataset-form.ts"],"sourcesContent":["import { JSONSchemaType } from \"ajv\";\nimport { SomeJSONSchema } from \"ajv/lib/types/json-schema\";\n\nexport type Collection = {\n  id: string;\n  name: string;\n  public: boolean;\n  lastJobId?: string;\n  lastJobSample?: boolean;\n  lastJobTime?: Date;\n  size: string;\n  sortSize: number;\n  seeds: number;\n  lastCrawlDate: Date;\n};\n\nexport type Dataset = {\n  category: string;\n  collectionId: string;\n  collectionName: string;\n  finishedTime?: Date;\n  id: string;\n  isSample: boolean;\n  jobId: string;\n  name: string;\n  numFiles: number;\n  sample: number; // -1 (not sample) or > 0 (sample)\n  startTime?: Date;\n  state: string;\n};\n\nexport enum JobId {\n  ArsLgaGeneration = \"ArsLgaGeneration\",\n  ArsWaneGeneration = \"ArsWaneGeneration\",\n  ArsWatGeneration = \"ArsWatGeneration\",\n  AudioInformationExtraction = \"AudioInformationExtraction\",\n  DomainFrequencyExtraction = \"DomainFrequencyExtraction\",\n  DomainGraphExtraction = \"DomainGraphExtraction\",\n  ImageGraphExtraction = \"ImageGraphExtraction\",\n  ImageInformationExtraction = \"ImageInformationExtraction\",\n  PdfInformationExtraction = \"PdfInformationExtraction\",\n  PresentationProgramInformationExtraction = \"PresentationProgramInformationExtraction\",\n  SpreadsheetInformationExtraction = \"SpreadsheetInformationExtraction\",\n  TextFilesInformationExtraction = \"TextFilesInformationExtraction\",\n  VideoInformationExtraction = \"VideoInformationExtraction\",\n  WebGraphExtraction = \"WebGraphExtraction\",\n  WebPagesExtraction = \"WebPagesExtraction\",\n  WordProcessorInformationExtraction = \"WordProcessorInformationExtraction\",\n}\n\nexport type Job = {\n  id: JobId;\n  name: string;\n  description: string;\n};\n\nexport type AvailableJobs = Array<{\n  categoryName: string;\n  categoryDescription: string;\n  categoryImage: string;\n  categoryId: string;\n  jobs: Array<Job>;\n}>;\n\nexport enum ProcessingState {\n  NotStarted = \"Not started\",\n  Queued = \"Queued\",\n  Running = \"Running\",\n  Finished = \"Finished\",\n  Failed = \"Failed\",\n}\n\nexport type JobState = {\n  id: string;\n  name: string;\n  sample: number;\n  state: ProcessingState;\n  started: boolean;\n  finished: boolean;\n  failed: boolean;\n  activeStage: string;\n  activeState: ProcessingState;\n  startTime?: string;\n  finishedTime?: string;\n};\n\nexport type PublishedDatasetInfo = {\n  item: string;\n  source: string;\n  collection: string;\n  job: JobId;\n  complete: boolean;\n  sample: boolean;\n  time: Date;\n  ark: string;\n};\n\nexport type PublishedDatasetMetadataApiResponse = {\n  creator?: Array<string>;\n  description?: Array<string>;\n  licenseurl?: Array<string>;\n  subject?: Array<string>;\n  title?: Array<string>;\n};\n\nexport type PublishedDatasetMetadata = {\n  creator?: Array<string>;\n  description?: string;\n  licenseurl?: string;\n  subject?: Array<string>;\n  title?: string;\n};\n\nexport type PublishedDatasetMetadataValue =\n  PublishedDatasetMetadata[keyof PublishedDatasetMetadata];\n\nexport type PublishedDatasetMetadataJSONSchema =\n  JSONSchemaType<PublishedDatasetMetadata>;\n\nexport type PublishedDatasetMetadataJSONSchemaProps = Record<\n  keyof PublishedDatasetMetadata,\n  SomeJSONSchema\n>;\n\n// API Types\n\nexport type BaseFilteredApiResponse<T> = {\n  count: number;\n  results: T;\n};\n\ntype FilteredApiResults<T> = Array<T>;\n\ntype DistinctApiResults<T> = Array<T[keyof T]>;\n\nexport type FilteredApiResponse<T> = BaseFilteredApiResponse<\n  FilteredApiResults<T>\n>;\n\nexport type DistinctApiResponse<T> = BaseFilteredApiResponse<\n  DistinctApiResults<T>\n>;\n\nexport type ApiResponse<T> = FilteredApiResponse<T> | DistinctApiResponse<T>;\n\ntype ApiParamOp = \"=\" | \"!=\";\n\ntype ApiFilterKey = \"distinct\" | \"limit\" | \"offset\" | \"search\" | \"sort\";\n\nexport type ApiParams<T> = Array<\n  [keyof T | ApiFilterKey, ApiParamOp, string | number | boolean]\n>;\n\nexport type ApiPath = \"/collections\" | \"/datasets\";\n","import { LitElement, html } from \"lit\";\nimport { customElement, property } from \"lit/decorators.js\";\n\nimport { Job, JobState } from \"../../lib/types\";\nimport { SAMPLE_JOB_ID_SUFFIX } from \"../../lib/constants\";\n\nexport enum JobButtonType {\n  Generate = \"generate\",\n  View = \"view\",\n  Status = \"status\",\n}\n\n@customElement(\"arch-job-card\")\nexport class ArchJobCard extends LitElement {\n  @property() collectionId!: string;\n  @property() job!: Job;\n  @property() jobStates!: Record<string, JobState>;\n\n  createRenderRoot() {\n    /* Disable the shadow root for this component to let in global styles.\n       https://stackoverflow.com/a/55213037 */\n    return this;\n  }\n\n  private jobStateToButtonProps(jobState: JobState | undefined) {\n    /* Return the [ButtonText, ButtonType, ClassName] tuple for the specificed JobState */\n    if (!jobState) {\n      return [\n        this.collectionId ? \"Loading...\" : \"n/a\",\n        JobButtonType.Status,\n        \"job-statebutton\",\n      ];\n    }\n    const sampleStr = jobState.sample > 0 ? \"Sample \" : \"\";\n    if (!jobState.started) {\n      return [\n        `Generate ${sampleStr}Dataset`,\n        JobButtonType.Generate,\n        \"job-runbutton\",\n      ];\n    }\n    if (jobState.finished) {\n      return [\n        `View ${sampleStr}Dataset`,\n        JobButtonType.View,\n        \"job-resultsbutton\",\n      ];\n    }\n    return [jobState.state, JobButtonType.Status, \"job-statebutton\"];\n  }\n\n  render() {\n    // Get the current job states.\n    const { collectionId, job } = this;\n    const { id: jobId } = job;\n    const [sampleJobState, jobState] = !this.jobStates\n      ? [undefined, undefined]\n      : [\n          this.jobStates[`${jobId}${SAMPLE_JOB_ID_SUFFIX}`],\n          this.jobStates[jobId],\n        ];\n    const [sampleButtonText, sampleButtonType, sampleClassName] =\n      this.jobStateToButtonProps(sampleJobState);\n    const [buttonText, buttonType, className] =\n      this.jobStateToButtonProps(jobState);\n    const title = collectionId\n      ? \"\"\n      : \"Select a source collection to enable this button\";\n    return html` <div class=\"card\">\n      <div class=\"card-body\">\n        <h2 class=\"card-title\">${job.name}</h2>\n        <p class=\"card-text\">${job.description}</p>\n        <div class=\"job-card-flex\">\n          <div class=\"job-card-sample\">\n            ${sampleButtonType === JobButtonType.View\n              ? html`\n                  <a\n                    href=\"/datasets/${this.collectionId}:${jobId}?sample=true\"\n                    class=\"button ${sampleClassName}\"\n                  >\n                    ${sampleButtonText}\n                  </a>\n                `\n              : html`\n                  <button\n                    class=\"job-button ${sampleClassName}\"\n                    style=\"display: block\"\n                    data-job-id=\"${jobId}\"\n                    data-button-type=\"${sampleButtonType}\"\n                    data-sample=\"\"\n                    title=\"${title}\"\n                  >\n                    ${sampleButtonText}\n                  </button>\n                `}\n          </div>\n          <div class=\"job-card-full\">\n            ${buttonType === JobButtonType.View\n              ? html`\n                  <a\n                    href=\"/datasets/${this.collectionId}:${jobId}\"\n                    class=\"button ${className}\"\n                  >\n                    ${buttonText}\n                  </a>\n                `\n              : html`\n                  <button\n                    class=\"job-button ${className}\"\n                    style=\"display: block\"\n                    data-job-id=\"${jobId}\"\n                    data-button-type=\"${buttonType}\"\n                    title=\"${title}\"\n                  >\n                    ${buttonText}\n                  </button>\n                `}\n          </div>\n        </div>\n      </div>\n    </div>`;\n  }\n}\n\n// Injects the tag into the global name space\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"arch-job-card\": ArchJobCard;\n  }\n}\n","import { LitElement, html } from \"lit\";\nimport { customElement, property } from \"lit/decorators.js\";\n\nimport { AvailableJobs, JobState } from \"../../lib/types\";\n\nimport \"./arch-job-card\";\n\n@customElement(\"arch-job-category-section\")\nexport class ArchJobCategorySection extends LitElement {\n  @property({ type: Boolean }) collapsed = false;\n  @property({ type: String }) collectionId!: string;\n  @property({ type: Object }) jobsCat!: AvailableJobs[0];\n  @property({ type: Object }) jobStates!: Record<string, JobState>;\n\n  createRenderRoot() {\n    /* Disable the shadow root for this component to let in global styles.\n       https://stackoverflow.com/a/55213037 */\n    return this;\n  }\n\n  expand() {\n    this.collapsed = false;\n  }\n\n  collapse() {\n    this.collapsed = true;\n  }\n\n  render() {\n    return html`\n      <div class=\"job-category ${this.collapsed ? \"collapsed\" : \"expanded\"}\">\n        <button\n          class=\"category-accordian-button\"\n          aria-controls=${this.jobsCat.categoryName}\n          aria-expanded=\"${this.collapsed ? \"false\" : \"true\"}\"\n        >\n          <img\n            class=\"category-image\"\n            src=\"${this.jobsCat.categoryImage}\"\n            alt=\"Icon for ${this.jobsCat.categoryName}\"\n          />\n          <span id=\"${this.jobsCat.categoryId}\" class=\"category-title\">\n            ${this.jobsCat.categoryName}\n          </span>\n          <br />\n          <span class=\"category-description\">\n            ${this.jobsCat.categoryDescription}\n          </span>\n        </button>\n        <div id=${this.jobsCat.categoryName} class=\"collapsible-content\">\n          ${this.jobsCat.jobs.map(\n            (job) => html`\n              <arch-job-card\n                .collectionId=${this.collectionId}\n                .job=${job}\n                .jobStates=${this.jobStates}\n              >\n              </arch-job-card>\n            `\n          )}\n        </div>\n      </div>\n    `;\n  }\n}\n\n// Injects the tag into the global name space\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"arch-job-category-section\": ArchJobCategorySection;\n  }\n}\n","import { css } from \"lit\";\n\nexport default css``;\n","import { LitElement, html } from \"lit\";\nimport { customElement, query, queryAll, state } from \"lit/decorators.js\";\n\nimport ArchAPI from \"../../lib/ArchAPI\";\nimport {\n  AvailableJobs,\n  Collection,\n  FilteredApiResponse,\n  JobState,\n  ProcessingState,\n} from \"../../lib/types\";\nimport { SAMPLE_JOB_ID_SUFFIX } from \"../../lib/constants\";\nimport { AlertClass, ArchAlert } from \"../../archAlert/index\";\nimport \"./arch-job-category-section\";\nimport { ArchJobCategorySection } from \"./arch-job-category-section\";\nimport { JobButtonType } from \"./arch-job-card\";\n\nimport Styles from \"./styles\";\n\n@customElement(\"arch-generate-dataset-form\")\nexport class ArchGenerateDatasetForm extends LitElement {\n  @state() collections: null | Array<Collection> = null;\n  @state() availableJobs: AvailableJobs = [];\n  @state() sourceCollectionId: string | null = null;\n  @state() jobStates: Record<string, Record<string, JobState>> = {};\n  @state() activePollCollectionId: string | null = null;\n  @state() anyErrors = false;\n\n  @query(\"select[name=source-collection]\")\n  collectionSelector!: HTMLSelectElement;\n  @query(\"arch-alert.error\") errorAlert!: ArchAlert;\n  @query(\"arch-alert.email\") emailAlert!: ArchAlert;\n  @queryAll(\"arch-job-category-section\")\n  categorySections!: Array<ArchJobCategorySection>;\n\n  // Apply any ARCH-specific styles.\n  static styles = Styles;\n\n  static urlCollectionParamName = \"cid\";\n\n  async connectedCallback() {\n    // Fetch available Collections and Jobs.\n    await this.initAvailableJobs();\n    void this.initCollections();\n    super.connectedCallback();\n    this.addEventListener(\"click\", (e: Event) => void this.clickHandler(e));\n  }\n\n  createRenderRoot() {\n    /* Disable the shadow root for this component to let in global styles.\n       https://stackoverflow.com/a/55213037 */\n    return this;\n  }\n\n  render() {\n    const collectionJobStates =\n      this.sourceCollectionId && this.jobStates[this.sourceCollectionId];\n    return html`\n      <label for=\"source-collection\">Select Source Collection</label>\n      <select\n        name=\"source-collection\"\n        @change=${this.sourceCollectionChangeHandler}\n        ?disabled=${this.collections === null}\n      >\n        ${this.collections === null\n          ? html`<option>Loading...</option>`\n          : html`<option value=\"\">~ Choose Source Collection ~</option>`}\n        ${(this.collections ?? []).map(\n          (collection) => html`\n            <option\n              value=\"${collection.id}\"\n              ?selected=${collection.id === this.sourceCollectionId}\n            >\n              ${collection.name}\n            </option>\n          `\n        )}\n      </select>\n\n      <arch-alert\n        class=\"sample\"\n        alertClass=${AlertClass.Secondary}\n        message=\"Sample datasets can be quickly generated in order to ensure that the analysis will produce datasets that meet your needs. These datasets use the first 100 relative records from the collection if they are available. We strongly recommend generating samples for any collections over 100GB.\"\n      ></arch-alert>\n\n      <arch-alert\n        class=\"email\"\n        alertClass=${AlertClass.Primary}\n        message=\"ARCH is creating your dataset. You will receive an email notification when the dataset is complete.\"\n        hidden\n      ></arch-alert>\n\n      <arch-alert\n        class=\"error\"\n        alertClass=${AlertClass.Danger}\n        message=\"A dataset generation job has failed, and we are currently investigating it.\"\n        ?hidden=${!this.anyErrors}\n      ></arch-alert>\n\n      ${this.availableJobs.map(\n        (jobsCat, i) => html`\n          <arch-job-category-section\n            .collectionId=${this.sourceCollectionId}\n            .jobsCat=${jobsCat}\n            .jobStates=${collectionJobStates}\n            ?collapsed=${i > 0}\n          >\n          </arch-job-category-section>\n        `\n      )}\n    `;\n  }\n\n  private setCollectionIdUrlParam(collectionId: Collection[\"id\"]) {\n    const { urlCollectionParamName } = ArchGenerateDatasetForm;\n    const url = new URL(window.location.href);\n    if (!collectionId) {\n      url.searchParams.delete(urlCollectionParamName);\n    } else {\n      url.searchParams.set(urlCollectionParamName, collectionId);\n    }\n    history.replaceState(null, \"\", url.toString());\n  }\n\n  private async sourceCollectionChangeHandler(e: Event) {\n    const collectionId = (e.target as HTMLSelectElement).value;\n    this.setCollectionIdUrlParam(collectionId);\n    await this.setSourceCollectionId(collectionId);\n    this.requestUpdate();\n  }\n\n  private updateAnyErrors() {\n    /* If collectionId is set, set anyErrors=true if any job failed, otherwise set\n     * anyErrors=false\n     */\n    const collectionId = this.sourceCollectionId as string;\n    if (collectionId) {\n      for (const jobState of Object.values(this.jobStates[collectionId])) {\n        if (jobState.state === ProcessingState.Failed) {\n          this.anyErrors = true;\n          return;\n        }\n      }\n    }\n    this.anyErrors = false;\n  }\n\n  private async setSourceCollectionId(collectionId: string) {\n    this.sourceCollectionId = collectionId;\n    // If a collection is selected, fetch the job states.\n    if (collectionId) {\n      this.jobStates[collectionId] = await this.fetchCollectionJobStates(\n        collectionId\n      );\n    }\n    // Update the visibility of the error alert.\n    this.updateAnyErrors();\n  }\n\n  private async initCollections() {\n    const response =\n      (await ArchAPI.collections.get()) as FilteredApiResponse<Collection>;\n    this.collections = response.results;\n    // Maybe select an initial Collection.\n    const initialCollectionId = new URLSearchParams(window.location.search).get(\n      ArchGenerateDatasetForm.urlCollectionParamName\n    );\n    if (initialCollectionId) {\n      await this.setSourceCollectionId(initialCollectionId);\n      this.requestUpdate();\n    }\n  }\n\n  private async initAvailableJobs() {\n    this.availableJobs = (await (\n      await fetch(\"/api/available-jobs\")\n    ).json()) as AvailableJobs;\n  }\n\n  private async fetchCollectionJobStates(collectionId: string) {\n    const data = (await (\n      await fetch(`/api/jobstates/${collectionId}?all=true`)\n    ).json()) as Array<JobState>;\n    // Transform the array of JobStates into an object keyed by job.id with sample-type\n    // jobs having an appended SAMPLE_JOB_ID_SUFFIX.\n    return Object.fromEntries(\n      data.map((x: JobState) => [\n        `${x.id}${x.sample > 0 ? SAMPLE_JOB_ID_SUFFIX : \"\"}`,\n        x,\n      ])\n    );\n  }\n\n  async pollJobStates() {\n    const collectionId = this.sourceCollectionId as string;\n    // Stop polling if the selected collection has changed.\n    if (this.activePollCollectionId !== collectionId) {\n      this.activePollCollectionId = null;\n      return;\n    }\n    // Fetch the current collection job states.\n    this.jobStates[collectionId] = await this.fetchCollectionJobStates(\n      collectionId\n    );\n    // Show the error alert if any jobs failed.\n    this.updateAnyErrors();\n    // Request a lit component update.\n    this.requestUpdate();\n    // Keep polling if any jobs remain active.\n    for (const jobState of Object.values(this.jobStates[collectionId])) {\n      if (jobState.state === ProcessingState.Running) {\n        // A job is active, set a polling timeout and return.\n        setTimeout(() => void this.pollJobStates(), 2000);\n        return;\n      }\n    }\n    // No jobs remain active, so stop polling.\n    this.activePollCollectionId = null;\n  }\n\n  private startPolling() {\n    // Abort if polling is already active.\n    if (this.activePollCollectionId !== null) {\n      return;\n    }\n    this.activePollCollectionId = this.sourceCollectionId;\n    void this.pollJobStates();\n  }\n\n  private expandCategorySection(categorySection: ArchJobCategorySection) {\n    this.categorySections.forEach((el) => {\n      if (el === categorySection) {\n        el.expand();\n      } else {\n        el.collapse();\n      }\n    });\n  }\n\n  private async runJob(jobId: string, sample: boolean) {\n    await fetch(\n      `/api/runjob/${jobId}/${this.sourceCollectionId as string}${\n        sample ? \"?sample=true\" : \"\"\n      }`\n    );\n  }\n\n  private async clickHandler(e: Event) {\n    const target = e.target as HTMLElement;\n    // Handle a collapsed category section click.\n    const categorySection = target.closest(\"arch-job-category-section\");\n    if (categorySection?.collapsed) {\n      this.expandCategorySection(categorySection);\n      return;\n    }\n\n    // Handle a job button click.\n    if (target.tagName === \"BUTTON\") {\n      const {\n        jobId,\n        buttonType,\n        sample: sampleStr,\n      } = target.dataset as {\n        jobId: string;\n        buttonType: string;\n        sample: string;\n      };\n      // Cast presence / absence of sample value to bool.\n      const sample = sampleStr !== undefined;\n      switch (buttonType) {\n        case JobButtonType.Generate:\n          // Run a job.\n          await this.runJob(jobId, sample);\n          this.emailAlert.show();\n          this.startPolling();\n          break;\n        case JobButtonType.View:\n          // View a dataset.\n          window.location.href = `/datasets/${\n            this.sourceCollectionId as string\n          }:${jobId}${sample ? \"?sample=true\" : \"\"}`;\n          break;\n      }\n      return;\n    }\n  }\n}\n\n// Injects the tag into the global name space\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"arch-generate-dataset-form\": ArchGenerateDatasetForm;\n  }\n}\n"],"names":["JobId","ProcessingState","JobButtonType","ArchJobCard","LitElement","createRenderRoot","this","jobStateToButtonProps","jobState","collectionId","Status","sampleStr","sample","started","finished","View","state","Generate","render","job","id","jobId","sampleJobState","jobStates","SAMPLE_JOB_ID_SUFFIX","undefined","sampleButtonText","sampleButtonType","sampleClassName","buttonText","buttonType","className","title","html","name","description","__decorate","property","prototype","customElement","ArchJobCategorySection","constructor","collapsed","expand","collapse","jobsCat","categoryName","categoryImage","categoryId","categoryDescription","jobs","map","type","Boolean","String","Object","css","ArchGenerateDatasetForm","ArchGenerateDatasetForm_1","collections","availableJobs","sourceCollectionId","activePollCollectionId","anyErrors","async","initAvailableJobs","initCollections","super","connectedCallback","addEventListener","e","clickHandler","collectionJobStates","sourceCollectionChangeHandler","_a","collection","AlertClass","Secondary","Primary","Danger","i","setCollectionIdUrlParam","urlCollectionParamName","url","URL","window","location","href","searchParams","set","delete","history","replaceState","toString","target","value","setSourceCollectionId","requestUpdate","updateAnyErrors","values","Failed","fetchCollectionJobStates","response","ArchAPI","get","results","initialCollectionId","URLSearchParams","search","fetch","json","data","fromEntries","x","Running","setTimeout","pollJobStates","startPolling","expandCategorySection","categorySection","categorySections","forEach","el","closest","tagName","dataset","runJob","emailAlert","show","styles","Styles","query","queryAll"],"mappings":"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"}